package steps;

import java.io.File;
import java.io.IOException;

import org.apache.commons.io.FileUtils;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;

import io.cucumber.java.After;
import io.cucumber.java.AfterStep;
import io.cucumber.java.Scenario;
import io.cucumber.java.pt.Dado;
import io.cucumber.java.pt.Então;
import io.cucumber.java.pt.Quando;
import pages.BuscaBlogPage;
import support.Utils;


public class BuscaBlogSteps {
	
	public WebDriver driver;
	public Utils utils;
	
	public BuscaBlogSteps(Utils utils) {
		this.utils = utils;
	}
	
	BuscaBlogPage buscaBlogPage = new BuscaBlogPage(utils.driver);

	@Dado("^que estou na página do blog de saúde e segurança do trabalho$")
	public void que_estou_na_página_do_blog_de_saúde_e_segurança_do_trabalho()  {
		buscaBlogPage.acessar_site();
	}
	
	@Quando("^digito a informação (.+) a ser procurada na barra de pesquisa$")
	public void digito_a_informação_a_ser_procurada_na_barra_de_pesquisa(String info) {
		buscaBlogPage.preencher_lacuna_procurar(info);
	}
	
	@Quando("^envio a solicitação da pesquisa$")
	public void envio_a_solicitação_da_pesquisa() {
		buscaBlogPage.procurar_info();
	}
	
	@Então("^recebo e verifico o resultado com as informações buscadas$")
	public void recebo_e_verifico_o_resultado_com_as_informações_buscadas() {
		buscaBlogPage.verificar_resultado();
	}
	
	/**@AfterStep
	public void AddScreenshot(Scenario scenario) throws IOException {
		File sourcePath = ((TakesScreenshot)buscaBlogPage.driver).getScreenshotAs(OutputType.FILE);
		//converter File para byte para usar o attach
		//uso pom apache commons IO para converter
		byte[] fileContent = FileUtils.readFileToByteArray(sourcePath);
		scenario.attach(fileContent, "image/png", "image");
		
	}
	
	@After
	public void finalizar_driver() {
		buscaBlogPage.sair_driver();
	}
	**/
}

